# 电信/移动 出口

在新校园网环境下（SCUNET+有线新网），虽然默认情况下上网是使用校园网出口，但是可以通过锐捷web认证，选择其他运营商宽带出口。在望江等寝室里使用锐捷客户端拨号一样可以选择其他出口，如果初次打开看不到运营商出口的选项话，只要在认证校园网后再在客户端里退出就可以看到其他出口选项了。

选择不同出口后，上网走的线路就是你所选择的线路出口。目前学校机房只有电信出口也有移动出口，没有和联通合作。

同时，同一账号可以绑定多个运营商的账号，每个出口都可以同时容纳1个设备，也就是说，你一个校园网账号最多可以在3个设备上用不同出口登录。

你可以将每次认证视为SAM服务器代你向电信的PPPoE服务器拨了一次号，因此在同一时间，电信宽带与你通过新校园网选择电信出口上网只能二选一。由于移动宽带只能在新校园网下使用，所以不用考虑这个情况。

### 使用方法：

1. **获取账号**：你需要先到营业厅去申请一个宽带账号（其实就是绑定了宽带的手机卡）。其中，移动的账号有两个，一个是宽带的账号，一个是WLAN的账号，两个不可混用，你需要使用的是宽带账号。
2. **自助绑定**：在校园网环境下登录[校园网自助服务中心](http://self.scu.edu.cn:8080/selfservice/)，在“我的运营商”选项按照要求填入自己对应运营商的账号和密码，绑定即可。注意，这里绑定的步骤是不会校验密码是否是能正常拨号的，任意账号密码组合均能绑定，只有在认证的时候才会验证。
  <div align="center">
  <img src="/assets/宽带绑定.jpg"/>
  <p>宽带绑定</p>
  </div>

3. **登录**：在新校园网的[认证界面](http://192.168.2.135)，你可以使用你绑定的任意账号密码组合登录账号对应的运营商出口或校园网出口，例如，你可以使用你绑定的电信宽带账号密码登录校园网出口，并且在认证成功界面不会显示姓名。新校园网是使用方法见[这个页面](../4/校园网使用方法.md)。
  <div align="center">
  <img src="/assets/登录其他出口.jpg"/>
  <p>登录其他宽带</p>
  </div>

4. 你或许发现了，根据2、3，你可以通过绑定一个错误的手机号和密码组合，向别人提供你的校园网账号，但是他靠一般的登录界面看不到你的真实姓名和学号，从而保护向陌生人出借账号时的隐私。

<br>

注：接下来的内容中，由于缺少望江测试账号，因此写的不全，只写了已经测试的内容。

# 出口线路
### 1.公网出口

公网出口同时接入了电信线路和教育网线路，其中，国外绝大部分服务器走教育网线路；对于国内的主要网络服务的服务器，如B站等，大部分流量走电信出口；对于国内的一些小服务器、教育网资源（如cnki）走教育网线路。（所以使用该出口依然可以下载知网的论文）

>公网用户访问校外资源，采用“多出口链路”等相关技术，校园网出口设备自动以最优链路选择不同网络运营商的网络出口，提高用户对不同网络资源的访问速度。

### 2.移动出口

移动出口接入的则是移动宽带，所有外网流量都会走移动线路。（所以使用该出口不可以下载知网的论文）

### 2.教育网出口

教育网出口是校园网在没有选择运营商出口情况下默认的出口，大部分流量会先经过北京的教育网出口，一部分流量会直接走成都的教育网出口，极小一部分走电信出口。

# 江安的情况

#### 1.覆盖：

你可以在[这个页面](../4/校园网使用方法.md)查看江安有线新校园网的覆盖范围。

#### 2.网络质量：
注：
1. 在教学区大楼，如果SCUNET有限速，则遵循限速规则，任意出口或者IPv6的带宽均是一样的。在寝室，则不同出口的IPv4带宽不一样。
2. 川大的校园网的IPv6不论是那个出口，分配的均是教育网IP地址。带宽共享教育网IPv6带宽，具体带宽请见[校园网质量](../4/校园网质量.md)。
3. 寝室区域的SCUNET，理论上与同区域新校园网的速度相同，但是由于无线协议以及无线传输的限制，实际达不到满速。具体请见[校园网质量](../4/校园网质量.md)。

|绑定的宽带|在江安认证时的上网出口|江安寝室有线新校园网使用时IPv4峰值带宽（单位Mbps）|
|:-:|:-:|:-:|
|江安办的电信宽带|公网出口|下载100上传35|
|江安办的移动宽带|移动出口|下载30上传30|
|望江办的电信宽带|未知|未知|
|望江办的移动宽带|未知|未知|

#### 3.路由器分享

江安的运营商出口由于均采用新校园网统一线路，因此实际上路由器使用方法与校园网相同，请参照[多设备使用方法](../4/多设备使用.md)。

# 望江的情况

#### 1.覆盖：

寝室有安装校园网接口的均可以通过锐捷客户端选择相关出口。

#### 2.网络质量：
注：
1. 在教学区大楼，如果SCUNET有限速，则遵循限速规则，任意出口或者IPv6的带宽均是一样的。在寝室，则不同出口的IPv4带宽不一样。
2. 川大的校园网的IPv6不论是那个出口，分配的均是教育网IP地址。带宽共享教育网IPv6带宽，具体带宽请见[校园网质量](../4/校园网质量.md)。
3. 望江寝室区域的SCUNET，由于不是与有线统一化的，所以具体带宽影响因素最大的其实是信号，由于无线协议以及无线传输的限制，基本达不到满速，最佳情况下比有线还是略差。

|绑定的宽带|在望江认证时的上网出口|望江寝室有线校园网使用时IPv4峰值带宽（单位Mbps）|
|:-:|:-:|:-:|
|江安办的电信宽带|公网出口|下载100上传35|
|江安办的移动宽带|公网出口|下载100上传35|
|望江办的电信宽带|未知|未知|
|望江办的移动宽带|未知|未知<br>（营业厅人员解释有30/20M两种速度，对应价格也不一样）|


#### 3.路由器分享

对于望江的校园网，不好直接在路由器上选择出口（不知道账号认证格式），但是我们理论上可以通过抓取Windows锐捷客户端账号认证时提交的数据包，来放到路由器里做对应出口的认证。

步骤如下：
1. 首先到[这里](https://github.com/syaoranwe/SCUNET/tree/master/code/Mentohust)下载一个Mentohust抓包工具，解压，你所需要的是该文件夹的 MentoHUSTTool.exe 以及其他依赖。在使用前，请自行到[这个页面](https://www.winpcap.org/install/)下载并安装  WinPcap.4.1.3.exe。
2. 连接好网线，运行图中的MentoHUSTTool.exe，网卡选择上面提到的那个“本地连接”或者“以太网”对应的有线网卡的名称，通常含有“Realtek”或者“Ethernet”，但绝对不含“Virtual”“Wireless”“WLAN”，选好网卡后，勾选“集成8021x.exe”和“集成W32N55.dll”。若提示未找到8021x.exe，就需要手动在锐捷客户端安装文件夹中寻找。之后启动锐捷客户端，登录校园网后再退出，以便来到可以选择出口的页面。

  <div align="center">
  <img src="/assets/锐捷抓包1.png"/>
  <p>MentoHUSTTool</p>
  </div>

3. 此时点击MentoHUSTTool的开始按钮，在锐捷客户端里填好账号密码并选择运营商出口进行认证，此时回到 MentoHUSTTool 这边，已经抓好包了，在弹出的窗口中填入你想保存的文件名，例如“telecom.mpf”，然后保存文件放到一个文件夹。
4. 将mpf数据文件上传到老毛子路由器里的一个位置（最好放在U盘，否则断电后会丢失，关于如何放在flash请参见[这个页面](https://github.com/syaoranwe/SCUNET/tree/master/code/%E5%A4%A9%E7%BF%BC%E9%A3%9Eyoung)），之后在后台管理界面的锐捷认证界面的自定义数据文件路径里面填入你的带路径的mpf文件，如`/etc/storage/telecom.mpf`，然后填入学号密码，应用设置就可以啦。
  <div align="center">
  <img src="/assets/自定义mpf.jpg"/>
  </div>
  <br>
  如果你用的是其他路由器，并在命令行下使用的Mentohust，只需要加入以下参数即可：

  ```
  -f mpf文件,记得带路径 -w
  例：-f /etc/storage/telecom.mpf -w
  注：-w: 保存指定的参数到配置文件
  ```

5. 如果认证失败的话，请再尝试将锐捷客户端安装目录里的 SuConfig.dat 这个文件上传到Mentohust程序所在的目录，老毛子默认是/usr/bin/mentohust。之后再尝试认证，一般就可以啦。
